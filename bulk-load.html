---
layout: default
title: API - BulkLoad
---

<h1>BulkLoad</h1>

<p>
  A <code>BulkLoad</code> instance is used to perform a bulk insert. 
  Use <a href="api-connection.html#function_newBulkLoad">connection.newBulkLoad</a> to create a new instance, 
  and <a href="api-connection.html#function_execBulkLoad">connection.execBulkLoad</a> to execute it 
  (see <a href="#usage">usage section</a>).
</p>

<ul class="toc">
  <li><a href="#usage">Usage</a></li>
  <li><a href="#function_addColumn">bulkLoad.addColumn(name, type, options)</a></li>
  <li><a href="#function_getTableCreationSql">bulkLoad.getTableCreationSql()</a></li>
  <li><a href="#function_setTimeout">bulkLoad.setTimeout(timeout)</a></li>
</ul>

<h2 id="usage">Usage</h2>
{% highlight javascript %}

// optional BulkLoad options
const options = { keepNulls: true };

// instantiate - provide the table where you'll be inserting to, options and a callback
const bulkLoad = connection.newBulkLoad('MyTable', options, function (error, rowCount) {
  console.log('inserted %d rows', rowCount);
});

// setup your columns - always indicate whether the column is nullable
bulkLoad.addColumn('myInt', TYPES.Int, { nullable: false });
bulkLoad.addColumn('myString', TYPES.NVarChar, { length: 50, nullable: true });

// execute
connection.execBulkLoad(bulkLoad, [
  { myInt: 7, myString: 'hello' },
  { myInt: 23, myString: 'world' }
]);
{% endhighlight %}

<div class="argument">
  <div class="name">options</div>
  <div class="description">
    <dl>
      <dt>
        <code>checkConstraints</code>
      </dt>
      <dd>
        <p>
          Honors constraints during bulk load, using T-SQL <a href="https://technet.microsoft.com/en-us/library/ms186247(v=sql.105).aspx">CHECK_CONSTRAINTS</a>. (default: <code>false</code>)
        </p>
      </dd>

      <dt>
        <code>fireTriggers</code>
      </dt>
      <dd>
        Honors insert triggers during bulk load, using the T-SQL <a href="https://technet.microsoft.com/en-us/library/ms187640(v=sql.105).aspx">FIRE_TRIGGERS</a>. (default: <code>false</code>)
      </dd>

      <dt>
        <code>keepNulls</code>
      </dt>
      <dd>
        Honors null value passed, ignores the default values set on table, using T-SQL <a href="https://msdn.microsoft.com/en-us/library/ms187887(v=sql.120).aspx">KEEP_NULLS</a>. (default: <code>false</code>)
      </dd>

      <dt>
        <code>tableLock</code>
      </dt>
      <dd>
        Places a bulk update(BU) lock on table while performing bulk load, using T-SQL <a href="https://technet.microsoft.com/en-us/library/ms180876(v=sql.105).aspx">TABLOCK</a>. (default: <code>false</code>)
      </dd>
      </dl>
  </div>
</div>

<h2 id="function_addColumn">bulkLoad.addColumn(name, type, options)</h2>
<p>
  Adds a column to the bulk load. The column definitions should match the table you are trying to insert into. 
  Attempting to call addColumn after the first row has been added will throw an exception.
</p>
{% highlight javascript %}
bulkLoad.addColumn('MyIntColumn', TYPES.Int, { nullable: false });
{% endhighlight %}
<div class="argument">
  <div class="name">name</div>
  <div class="description">
    <p>
      The name of the column.
    </p>
  </div>
</div>
<div class="argument">
  <div class="name">type</div>
  <div class="description">
    <p>
      One of the supported <a href="api-datatypes.html"><code>data types</code></a>.
    </p>
  </div>
</div>
<div class="argument">
  <div class="name">options</div>
  <div class="description">
    <p>
      Additional column type information. At a minimum, <code>nullable</code> must be set to true or false.
      <ul>
        <li><code>nullable</code> indicates whether the column accepts NULL values.</li>
        <li id="objName">
          <code>objName</code> If the name of the column is different from the name of the property found on 
          row objects passed to <a href="api-connection.html#function_execBulkLoad"></a>, then you can use this option
          to specify the property name.
        </li>
        <li><code>length</code> for VarChar, NVarChar, VarBinary. Use length as <code>Infinity</code> for VarChar(max), NVarChar(max) and VarBinary(max).</li>
        <li><code>precision</code> for Numeric, Decimal</li>
        <li><code>scale</code> for Numeric, Decimal, Time, DateTime2, DateTimeOffset</li>
      </ul>
    </p>
  </div>
</div>

<h2 id="function_getTableCreationSql">bulkLoad.getTableCreationSql()</h2>
<p>
  This is simply a helper utility function which returns a <code>CREATE TABLE</code> SQL statement based on the
  columns added to the bulkLoad object. This may be particularly handy when you want to insert into a temporary
  table (a table which starts with <code>#</code>).
</p>
{% highlight javascript %}
var sql = bulkLoad.getTableCreationSql();
{% endhighlight %}
<p>
  A side note on bulk inserting into temporary tables: if you want to access a local temporary table after
  executing the bulk load, you'll need to use the same connection and execute your requests using 
  <a href="api-connection.html#function_execSqlBatch">connection.execSqlBatch</a> instead of .execSql.
</p>

<h2 id="function_setTimeout">bulkLoad.setTimeout(timeout)</h2>
<p>
 Sets a timeout for this bulk load.
</p>
{% highlight javascript %}
bulkLoad.setTimeout(timeout);
{% endhighlight %}
<div class="argument">
  <div class="name">timeout</div>
  <div class="description">
    <p>
      The number of milliseconds before the bulk load is considered failed, or 0 for no timeout.
    </p>
  </div>
</div>
<p>
  When no timeout is set for the bulk load, the <code>options.requestTimeout</code> of the <code>Connection</code> is used.
</p>
